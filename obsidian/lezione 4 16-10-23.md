# Bridge / Switch

## Bridge / Switch
I bridge sono pensati per realizzare reti locali con molti computer.
I bridge e gli switch sono sinonimi per ora

## Rete con bridge
vari computer possono essere collegati ad un solo bridge, le schede del bridge a cui si collegano i vari fili del pc si chiamano **porte**.

I bridge possono essere collegati tra di loro permettendo di relizzare reti ancora più complesse

## Filtering
Il bridge cerca di ritrasmettere solo pacchetti che devono effettivamente passare attraverso la LAN, i traffici di pacchetti "locali" sono tenuti separati

se X trasmette un pacchetto a Y, allora i bridge intermedi cercano di non trasmettere il pacchetto verso porzioni della LAN che non contengono il cammino verso Y

## Store & Forward

Ogni pacchetto viene memorizzato nel bridge completamente, poi viene messo in coda (buffer), e ritrasmesso per la sua destinazione

## Mac dei bridge
le porte di un bridge possono avere lo stesso MAC oppure MAC differenti, con MAC differenti è necessario effettuare una traduzione di formato del pacchetto tra porta a porta

## Learning
I bridge costruiscono la tabella di instradamento automaticamente (chiamata anche **filtering database**) con un processo di **learning**.

Riconosce da che parte del LAN il pacchetto viene e crea la sua mappa

## Spanning tree
- Il processo di learning funziona solamente se la mappa della LAN è ad albero
- La mappa tipicamente non è un albero ma un grafo per questioni di sicurezza (malfunzionamenti)
- Viene creato uno spanning tree bloccando alcune porte del grafo per evitare cicli

## Prestazioni del bridge
- Influenzano l'intera rete locale
- Parametri che caratterizzano un bridge:
	- numero massimo di pacchetti al secondo processabili
	- tempo medio di latenza: tempo di attraversamento del bridge da parte di un pacchetto, dall'ingresso alla ritrasmissione.

 - E' preferibile che un bridge sia full speed: parametri pari al massimo teorico
 - più sono corti i pacchetti e più è alto il numero di decisioni da prendere da parte del bridge nell'unità di tempo
	 - bisogna sperimentare con la grandezza minima di pacchetti. La latenza dipende anche dalla grandezza del pacchetto

# Architettura fisica
- cpu + memoria + interfacce LAN4
- ROM con funzionalità dello standard IEEE 802.1D, in RAM tabelle di instradamento, buffer dati e strutture dati ausiliarie
- alternativa schede ASIC (Application Specific Integrated Circuit), che risolve localmente parte dell'instradamento

# Architettura logica
- due o più porte
- MAC relay entity per ritrasmissione, filtraggio e learning (sostanza del bridge/switch)
- entità di livello superiore per calcolo dello spanning tree e il controllo generale del bridge


## Stato delle porte
- L'amministratore di rete può attivare (**enabled**) o disattivarla (**disabled**)
- una porta attiva (**enabled**) può essere in stato di forwarding o di blocking, per utilità all'algoritmo di spanning tree
- Le porte hanno indirizzi MAC con numeri progressivamente più grandi a partire da 1, l'indirizzo del bridge è uguale all'indirizzo MAC della porta 1

## Tabella di instradamento
- la tabella contiene entry (righe) **statiche** ed entry **dinamiche**
- il processo di learning si basa sugli indirizzi mittente dei pacchetti ascoltati 
- il valore di default per la sopravvivenza delle entry dinamiche è 5 minuti, dopodiche vengono cancellate

## Controllo di flusso
Dato che ci può essere differenza nella velocità di trasferimento di dati tra vari utenti e bridge collegati alla rete, viene introdotto il **pause frame** di 512 bit per evitare che il buffer vada in saturazione e che debba scartare pacchetti

#### Pause frame
Fa parte di un nuovo sottostrato di MAC denominato MAC control, il supporto a 802.3x è opzionale e viene negoziato tra le schede alle due estremità del filo.
